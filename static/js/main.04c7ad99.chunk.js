(this["webpackJsonpmovies-app"]=this["webpackJsonpmovies-app"]||[]).push([[0],{173:function(e,t,n){},334:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(27),c=n.n(s),i=n(8),o=n(14),u=n(16),h=n(18),l=n(17),p=(n(123),n(173),a.a.createContext()),b=p.Provider,d=p.Consumer,j=n(345),f=n(341),g=n(10),v=j.a.Header,m=function(e){var t=e.onInputChange;return Object(g.jsx)(v,{children:Object(g.jsx)(f.a,{placeholder:"Type to search...",onChange:t})})},O=n(22),y=n.n(O),x=n(37),k=function(){function e(){Object(o.a)(this,e),this.apiKey="162123c84167fbeaf28191b62529a99d",this.baseStr="https://api.themoviedb.org/3/",this.requestGet=function(e){return fetch(e).then((function(t){if(!t.ok)throw new Error("error fetch URL ".concat(e,", response status ").concat(t.status));return t.json()}))}}return Object(u.a)(e,[{key:"creatGuestSession",value:function(){var e=Object(x.a)(y.a.mark((function e(){var t,n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.baseStr,"authentication/guest_session/new?api_key=").concat(this.apiKey),e.next=3,this.requestGet(t);case 3:return n=e.sent,r=n.guest_session_id,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMovies",value:function(){var e=Object(x.a)(y.a.mark((function e(t,n){var r,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(this.baseStr,"search/movie?api_key=").concat(this.apiKey,"&query=").concat(t,"&page=").concat(n),e.next=3,this.requestGet(r);case 3:return a=e.sent,e.abrupt("return",{totalPages:a.total_pages,list:a.results});case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getGenres",value:function(){var e=Object(x.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.baseStr,"genre/movie/list?api_key=").concat(this.apiKey),e.next=3,this.requestGet(t);case 3:return n=e.sent,e.abrupt("return",n.genres);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"rateFilm",value:function(){var e=Object(x.a)(y.a.mark((function e(t,n,r){var a,s,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(this.baseStr,"movie/").concat(t,"/rating?api_key=").concat(this.apiKey,"&guest_session_id=").concat(n),s={value:r},c={"Content-Type":"application/json;charset=utf-8"},e.next=5,fetch(a,{method:"POST",body:JSON.stringify(s),headers:c});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"deleteRateFilm",value:function(){var e=Object(x.a)(y.a.mark((function e(t,n){var r,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(this.baseStr,"movie/").concat(t,"/rating?api_key=").concat(this.apiKey,"&guest_session_id=").concat(n),a={"Content-Type":"application/json;charset=utf-8"},e.next=4,fetch(r,{method:"DELETE",headers:a});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getRatedFilms",value:function(){var e=Object(x.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.baseStr,"guest_session/").concat(t,"/rated/movies?api_key=").concat(this.apiKey),e.next=3,this.requestGet(n);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),w=n(157),C=n(339),_=n.p+"static/media/no-pictures.5533b14a.png",L=n(344),P=n(343),S=function(e){Object(h.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={genresList:e.props.genresList},e.movieGenreList=function(t){var n,r=[],a=Object(w.a)(t);try{var s=function(){var t=n.value;e.state.genresList.forEach((function(e){e.id===t&&r.push(e.name)}))};for(a.s();!(n=a.n()).done;)s()}catch(c){a.e(c)}finally{a.f()}return r},e.formatDateRelease=function(e){return Object(C.a)(new Date(e),"MMM Q, y")},e.shortenText=function(e,t){if(e.length>t){if(" "===e.substring(t-1,t))return e.substring(0,t)+"...";var n=e.substring(0,t).lastIndexOf(" ");return e.substring(0,n)+"..."}return e},e.rating\u0421hanges=function(t){var n=new k,r=e.props.item.id,a=e.props.token;0===t?n.deleteRateFilm(r,a):n.rateFilm(r,a,t)},e.defineRating\u0421olor=function(e){var t;return e<=3?t="#E90000":e<=5?t="#E97E00":e<=7?t="#E9D100":e>7&&(t="#66E900"),{borderColor:t}},e.showPoster=function(e){return null!==e?"https://image.tmdb.org/t/p/w200/".concat(e):_},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.item,t=e.title,n=e.poster_path,r=e.overview,s=e.release_date,c=e.genre_ids,i=e.vote_average,o=e.rating,u=this.showPoster(n),h=this.shortenText(r,180),l=this.shortenText(t,30),p=s?this.formatDateRelease(s):null,b=this.defineRating\u0421olor(i),d=o||0,j=this.movieGenreList(c),f=Object(g.jsx)(a.a.Fragment,{children:j.map((function(e,t){return Object(g.jsx)("span",{className:"ant-card-body_genre-item",children:e},t)}))});return Object(g.jsxs)(L.a,{className:"ant-card",hoverable:!0,cover:Object(g.jsx)("img",{alt:"poster",src:u}),children:[Object(g.jsx)("div",{style:b,className:"ant-card-body_rating",children:i}),Object(g.jsx)("div",{className:"ant-card-body_title",children:l}),Object(g.jsx)("div",{className:"ant-card-body_data",children:p}),Object(g.jsx)("div",{className:"ant-card-body_genres",children:f}),Object(g.jsxs)("p",{className:"ant-card-body_text",children:[" ",h]}),Object(g.jsx)("div",{className:"ant-card-body_genre-stars",children:Object(g.jsx)(P.a,{disabled:!!d,defaultValue:d,count:10,onChange:this.rating\u0421hanges})})]})}}]),n}(r.Component),E=n(346),F=n(338),N=function(){return Object(g.jsx)(E.b,{size:"large",children:Object(g.jsx)(F.a,{size:"large",className:"loader"})})},T=n(342),G=n(340),R=n(101),Q=n(161),I=function(e){Object(h.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={moviesList:[],loading:!1,error:!1,notFound:!1,totalPages:null},e.getList=function(t,n){(new k).getMovies(t,n).then((function(t){e.setState({moviesList:Object(i.a)(t.list),loading:!1,error:!1,totalPages:t.totalPages}),0===e.state.moviesList.length&&e.setState({notFound:!0})})).catch(e.onError)},e.debounced=Object(Q.debounce)(e.getList,500),e.onError=function(){e.setState({error:!0,loading:!1})},e}return Object(u.a)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.searchQuery,r=t.numberPage;n===e.searchQuery&&r===e.numberPage||(this.setState({loading:!0,error:!1,notFound:!1}),this.debounced(n,r))}},{key:"render",value:function(){var e=this.state,t=e.moviesList,n=e.loading,r=e.error,s=e.notFound,c=e.totalPages,i=this.props,o=i.searchQuery,u=i.numberPage,h=i.onPageChange,l=i.token,p=r&&""!==o?Object(g.jsx)(T.a,{message:"Error",description:"Oops, something went wrong :-(",type:"error",showIcon:!0}):null,b=r||n||!s?null:Object(g.jsx)(T.a,{message:"No results were found for your search!",type:"info",showIcon:!0}),j=n?Object(g.jsx)(N,{}):null,f=n||r?null:Object(g.jsx)(d,{children:function(e){return Object(g.jsx)(a.a.Fragment,{children:t.map((function(t){var n=t.id;return Object(g.jsx)(S,{item:t,genresList:e,token:l},n)}))})}}),v=c>5,m=10*c,O=0===t.length||""===o||n?null:Object(g.jsx)(G.a,{size:"small",showQuickJumper:v,defaultCurrent:u,total:m,onChange:h,showSizeChanger:!1});return Object(g.jsxs)(a.a.Fragment,{children:[Object(g.jsxs)(R.Content,{children:[j,f,p,b]}),O]})}}]),n}(r.Component),K=function(e){var t=e.rateList;return Object(g.jsx)(R.Content,{children:Object(g.jsx)(d,{children:function(e){return t.map((function(t){var n=t.id;return Object(g.jsx)(S,{item:t,genresList:e},n)}))}})})},D=n(122),q=D.a.TabPane,M=function(e){Object(h.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={searchQuery:null,numberPage:1,genresList:[],rateList:[],token:null},e.onInputChange=function(t){e.setState({searchQuery:t.target.value,numberPage:1})},e.onPageChange=function(t){e.setState({numberPage:t})},e.onTabClick=function(t){"2"===t&&(new k).getRatedFilms(e.state.token).then((function(t){e.setState({rateList:Object(i.a)(t.results)})}))},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=new k;t.creatGuestSession().then((function(t){e.setState({token:t})})),t.getGenres().then((function(t){e.setState({genresList:Object(i.a)(t)})}))}},{key:"render",value:function(){var e=this.state,t=e.searchQuery,n=e.numberPage,r=e.genresList,a=e.token,s=e.rateList;return Object(g.jsx)(b,{value:r,children:Object(g.jsx)("div",{className:"container",children:Object(g.jsx)(j.a,{children:Object(g.jsxs)(D.a,{defaultActiveKey:"1",onTabClick:this.onTabClick,children:[Object(g.jsxs)(q,{tab:"Search",children:[Object(g.jsx)(m,{onInputChange:this.onInputChange}),Object(g.jsx)(I,{searchQuery:t,numberPage:n,onPageChange:this.onPageChange,token:a})]},"1"),Object(g.jsx)(q,{tab:"Rated",children:Object(g.jsx)(K,{token:a,rateList:s})},"2")]})})})})}}]),n}(r.Component);c.a.render(Object(g.jsx)(M,{}),document.getElementById("root"))}},[[334,1,2]]]);
//# sourceMappingURL=main.04c7ad99.chunk.js.map